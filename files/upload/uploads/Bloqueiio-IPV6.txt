/ipv6 firewall filter {remove [find comment~"block-ipv6"];add action=drop chain=forward src-address-list=suspended comment="block-ipv6";add action=drop chain=forward dst-address-list=suspended comment="block-ipv6";};/system script {remove [find name~"block-ipv6"];add dont-require-permissions=no name=block-ipv6-up owner=webmikrotik policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive,romon source=":delay 2;:local ipv6 [:toarray \"\"];:local dpd [/ipv6 dhcp-server binding find server=(\"<pppoe-\".\$user.\">\")];:foreach i in=\$dpd do={:set ipv6 (\$ipv6 + [:toarray [/ipv6 dhcp-server binding get \$i address]]);};:local ppd [/ipv6 pool used find info=\$user];:foreach i in=\$ppd do={:set ipv6 (\$ipv6 + [:toarray [/ipv6 pool used get \$i prefix]]);};:local lista \"suspended\";:foreach i in=\$ipv6 do={/ipv6 firewall address-list {remove [find list=\$lista address=\$i];add list=\$lista comment=\$user address=\$i;};};";add dont-require-permissions=no name=block-ipv6-down owner=webmikrotik policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive,romon source="/ipv6 firewall address-list remove [find comment=\$user];";};/ppp profile set [find name~"suspended"] on-up="block-ipv6-up" on-down="block-ipv6-down";/system scheduler {remove [find name="block-ipv6"];add name=block-ipv6 on-event="/ipv6 firewall address-list remove [find list=\"suspended\"];";};
